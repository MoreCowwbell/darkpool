#!/usr/bin/env python
"""Temporary script to drop scanner tables from DuckDB."""
import duckdb
from pathlib import Path

db_path = Path(__file__).parent / "darkpool_analysis" / "data" / "darkpool.duckdb"
print(f"Connecting to: {db_path}")

conn = duckdb.connect(str(db_path))

# Check which tables exist
tables_to_drop = ["scanner_daily_metrics", "finra_short_daily_all_raw"]
existing = conn.execute(
    f"SELECT table_name FROM information_schema.tables WHERE table_name IN {tuple(tables_to_drop)}"
).fetchall()

print(f"Tables found: {[t[0] for t in existing]}")

for table in existing:
    table_name = table[0]
    print(f"Dropping table: {table_name}")
    conn.execute(f"DROP TABLE IF EXISTS {table_name}")

conn.close()
print("Done - scanner tables dropped.")
